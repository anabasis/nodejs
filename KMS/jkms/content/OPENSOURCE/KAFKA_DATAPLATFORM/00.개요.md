# 카프카 데이터 플랫폼의 최강자

## 1부 카프카를 시작하며

## 1장 카프카란 무엇인가

### 1.1 카프카의 탄생 배경
### 1.2 카프카의 동작 방식과 원리
### 1.3 카프카의 특징
### 1.4 카프카의 확장과 발전
### 1.5 정리

## 2장 카프카와 주키퍼 설치

### 2.1 카프카 관리를 위한 주키퍼
### 2.2 주키퍼 설치
2.2.1 주키퍼 다운로드
2.2.2 주키퍼 실행
### 2.3 카프카 설치
2.3.1 카프카 다운로드
2.3.2 카프카 환경설정
2.3.3 카프카 실행
### 2.4 카프카 상태 확인
2.4.1 TCP 포트 확인
2.4.2 주키퍼 지노드를 이용한 카프카 정보 확인
2.4.3 카프카 로그 확인
### 2.5 카프카 시작하기
### 2.6 정리

## 2부 기본 개념과 운영 가이드

## 3장 카프카 디자인

### 3.1 카프카 디자인의 특징

3.1.1 분산 시스템
3.1.2 페이지 캐시
3.1.3 배치 처리

### 3.2 카프카 데이터 모델

3.2.1 토픽의 이해
3.2.2 파티션의 이해
3.2.3 오프셋과 메시지 순서

### 3.3 카프카의 고가용성과 리플리케이션

3.3.1 리플리케이션 팩터와 리더, 팔로워의 역할
3.3.2 리더와 팔로워의 관리

### 3.4 모든 브로커가 다운된다면

### 3.5 카프카에서 사용하는 주키퍼 지노드 역할

### 3.6 정리

## 4장 카프카 프로듀서

### 4.1 콘솔 프로듀서로 메시지 보내기

### 4.2 자바와 파이썬을 이용한 프로듀서

4.2.1 메시지를 보내고 확인하지 않기
4.2.2 동기 전송
4.2.3 비동기 전송

### 4.3 프로듀서 활용 예제

### 4.4 프로듀서 주요 옵션

### 4.5 메시지 전송 방법

4.5.1 메시지 손실 가능성이 높지만 빠른 전송이 필요한 경우
4.5.1 메시지 손실 가능성이 적고, 적당한 속도의 전송이 필요한 경우
4.5.2 전송 속도는 느리지만, 메시지 손실이 없어야 하는 경우

### 4.6 정리

## 5장 카프카 컨슈머

### 5.1 컨슈머 주요 옵션

### 5.2 콘솔 컨슈머로 메시지 가져오기

### 5.3 자바와 파이썬을 이용한 컨슈머

### 5.4 파티션과 메시지 순서

5.4.1 파티션3개로 구성한 peter-01토픽과 메시지 순서
5.4.2 파티션1개로 구성한 peter-02토픽과 메시지 순서

### 5.5 컨슈머 그룹

### 5.6 커밋과 오프셋

5.6.1 자동 커밋
5.6.2 수동 커밋
5.6.3 특정 파티션 할당
5.6.4 특정 오프셋부터 메시지 가져오기

### 5.7 정리

## 6장 카프카 운영 가이드

### 6.1 필수 카프카 명령어

6.1.1 토픽 생성
6.1.2 토픽 리스트 확인
6.1.3 토픽 상세보기
6.1.4 토픽 설정 변경
6.1.5 토픽의 파티션 수 변경
6.1.6 토픽의 리플리케이션 팩터 변경
6.1.7 컨슈머 그룹 리스트 확인
6.1.8 컨슈머 상태와 오프셋 확인

### 6.2 주키퍼 스케일 아웃

### 6.3 카프카 스케일 아웃

### 6.4 카프카 모니터링

6.4.1 카프카 JMX 설정 방법
6.4.2 JMX 모니터링 지표

### 6.5 카프카 매니저

6.5.1 카프카 매니저 설치
6.5.2 카프카 클러스터 등록
6.5.3 카프카 매니저 메뉴 설명

### 6.6 카프카 운영에 대한 Q&A

### 6.7 정리

## 3부 카프카의 확장과 응용

## 7장 카프카를 활용한 데이터 파이프라인 구축

### 7.1 카프카를 활용한 데이터 흐름도

### 7.2 파일비트를 이용한 메시지 전송

7.2.1 파일비트 설치
7.2.2 파일비트 설정
7.2.3 카프카 토픽의 메시지 유입 확인

### 7.3 나이파이를 이용해 메시지 가져오기

7.3.1 나이파이 설치
7.3.2 나이파이 설정
7.3.3 나이파이를 이용한 컨슈머 설정

### 7.4 실시간 분석을 위해 엘라스틱서치에 메시지 저장

7.4.1 엘라스틱서치 설치
7.4.2 엘라스틱서치 설정
7.4.3 나이파이를 이용해 엘라스틱서치로 데이터 전송

### 7.5 키바나를 이용해 엘라스틱서치에 저장된 데이터 확인

7.5.1 키바나 설치
7.5.2 키바나 설정

### 7.6 현재의 토픽을 이용해 새로운 토픽으로 메시지 재생산

7.6.1 나이파이를 이용한 카프카 컨슈머 추가
7.6.2 나이파이를 이용한 토픽별 라우팅 작업

### 7.7 정리

## 8장 카프카 스트림즈 API

### 8.1 스트림 프로세싱 기초

8.1.1 스트림 프로세싱과 배치 프로세싱
8.1.2 상태 기반과 무상태 스트림 처리

### 8.2 카프카 스트림즈

8.2.1 카프카 스트림즈의 특징과 개념
8.2.2 카프카 스트림즈 아키텍처

### 8.3 카프카 스트림즈를 위한 환경설정

### 8.4 파이프 예제 프로그램 만들기

### 8.5 행 분리 예제 프로그램 만들기

### 8.6 단어 빈도수 세기 예제 프로그램 만들기

### 8.7 정리

## 9장 카프카 SQL을 이용한 스트리밍 처리

### 9.1 KSQL의 등장 배경

### 9.2 KSQL과 카파 아키텍처

### 9.3 KSQL 아키텍처

9.3.1 KSQL 서버
9.3.2 KSQL 클라이언트

### 9.4 도커를 이용한 KSQL 클러스터설치

### 9.5 KSQL을 이용한 스트림 분석

9.5.1 데이터 준비
9.5.2 기본 스트림과 테이블 생성
9.5.3 쿼리를 이용한 새로운 스트림과 테이블 생성

### 9.6 정리

## 10장 그 밖의 클라우드 기반 메시징 서비스

### 10.1 구글의 펍/섭 서비스 소개

### 10.2 구글의 펍/섭 서비스 연동

10.2.1 구글 SDK 설치
10.2.2 구글 펍/섭 CLI로 토픽 사용

### 10.3 펍/섭 파이썬 SDK 사용하기

10.3.1 펍/섭 파이썬 라이브러리 설치
10.3.2 구글 서비스 계정 인증정보 생성
10.3.3 파이썬 SDK 사용하기

### 10.4 아마존 키네시스 서비스 소개

### 10.5 아마존 키네시스 연동

10.5.1 아마존 CLI 설치
10.5.2 아마존 CLI로 키네시스 사용하기

### 10.6 아마존 키네시스 자바 SDK 사용하기

10.6.1 컨슈머 코드 예제
10.6.2 프로듀서 코드 예제

### 10.7 카프카와 클라우드 서비스와의 비교

### 10.8 정리

## 부록 도커를 이용한 카프카 설치

### A.1 도커 설치

A.1.1 리눅스 버전 도커 설치
A.1.2 맥 버전 도커 설치
A.1.3 윈도우 버전 도커 설치

### A.2 도커 버전 카프카 설치

## 이책의 구성

### '1부, 카프카를 시작하며'

'__1장__, 카프카 소개'에서는 카프카가 탄생할 당시 링크드인의 상황을 통해 데이터 처리 시스템의 변화를 알아보면서 카프카의 역사를 살펴본다. 또한, 메시징 시스템의 기본적인 동작 방식과 카프카의 특징도 자세히 알아본다.
'__2장__, 카프카 설치'에서는 대표적인 분산 애플리케이션인 카프카를 위한 안정적인 코디네이션 애플리케이션인 주키퍼에 대해 자세히 알아보고 주키퍼와 카프카의 관계를 살펴본다. 어느 책에서도 자세히 다루지 않아 사용자들이 가장 어려워하는 주키퍼 설치 과정을 그림과 코드와 함께 설명하고 카프카를 설치하고 실행, 상태 확인하는 과정까지 단계별로 자세히 설명한다.

### '2부, 기본 개념과 운영 가이드'

'__3장__, 카프카 디자인'에서는 분산 시스템, 페이지 캐시, 배치 처리로 대표되는 카프카의 특징과 함께 고성능, 고가용성으로 대변되는 카프카 리플리케이션의 개념, 리더와 팔로워의 역할을 다룬다. 또한 카프카에서 사용하는 필수 용어를 알아보고 카프카에서 사용하는 주키퍼의 지노드에 대해 알아본다.
'__4장__, 카프카 프로듀서'에서는 프로듀서의 주요 옵션을 알아보고, 콘솔 프로듀서, 자바와 파이썬 언어를 이용한 프로듀서 예제 코드를 실행해보고, 메시지 전송 방법으로서 동기 전송과 비동기 전송 방법에 대해 알아본다. 그 외에도 프로듀서의 옵션에 따라 손실 없이 메시지를 전송하는 방법도 자세히 살펴본다.
'__5장__, 카프카 컨슈머'에서는 컨슈머의 주요 옵션을 알아보고, 간단한 컨슈머를 직접 구현해보며 파티션 개수에 따라 메시지를 가져올 때의 주의사항과 자동 커밋, 수동 커밋과 오프셋에 대한 내용을 다룬다.
'__6장__, 카프카 운영 가이드'에서는 카프카를 운영하면서 반드시 알아둬야 하는 필수 카프카 명령어들과 카프카 모니터링 방법에 대해 자세히 살펴보고, 카프카를 좀 더 손쉽게 관리할 수 있는 GUI 관리도구인 카프카 매니저의 설치와 활용 방법도 알아본다. 카프카 운영에 대해 자주 묻는 질문과 답변도 정리해 실었다.

### '3부, 카프카의 확장과 응용'

'__7장__, 카프카 활용'에서는 최근 많이 사용되고 있는 엘라스틱서치(Elasticsearch), 키바나(Kibana), 파일비트(Filebeat) 등을 활용해 실제로 메시지를 보내고, 가져오며, 저장한 후, 확인하는 방법까지 실제 예제를 통해 배워보며 아파치 나이파이(NiFi)를 이용해 데이터 파이프라인을 구성하는 예제까지 다룬다.
'__8장__ 카프카 스트림즈 API'에서는 스트림 프로세싱의 개념을 알아보고, 스파크나 스톰과 같은 별도의 스트리밍 엔진 없이도 카프카를 이용해 실시간 분석을 수행할 수 있는 방법을 실전 예제와 함께 배워본다. 또한, 카프카 스트림즈 API를 이용해 파이프, 행 분리, 단어 빈도수 세기 프로그램도 만들어본다.
'__9장__, KSQL을 이용한 스트리밍 처리'에서는 KSQL의 등장 배경과 KSQL 아키텍처에 대해 자세히 알아보고, 별도의 앱을 개발하지 않고도 KSQL의 간단한 쿼리문만으로도 실시간 스트리밍 데이터로 다양한 분석이 가능한, KSQL을 이용한 스트림 분석 방법을 살펴본다.
'__10장__, 그 밖의 클라우드 기반 메시징 서비스'에서는 카프카를 사용하기 어려운 환경이나 직접 메시징 서비스를 운영하기 어려운 회사에서 카프카의 대안으로, 클라우드 기반의 메시징 서비스를 활용해볼 수 있도록 각 서비스의 개요, 연동, 사용 방법 등을 알아본다. 마지막으로, 카프카와 여타 클라우드 기반 메시징 서비스를 비교해본다.

### 부록

'__부록__, 도커를 이용한 카프카 설치'에서는 카프카를 서버에 직접 설치하지 않고도 사용할 수 있는 방법으로, 최근 인기가 높은 도커(Docker)를 이용한 카프카 설치 방법을 리눅스, 맥, 윈도우 버전별로 살펴본다.

예제코드 <https://github.com/onlybooks/kafka>

## 차례

## 1부 카프카를 시작하며
### 1장  카프카란 무엇인가
1.1  카프카의 탄생 배경
1.2  카프카의 동작 방식과 원리
1.3  카프카의 특징
1.4  카프카의 확장과 발전
1.5  정리

### 2장  카프카와 주키퍼 설치
2.1  카프카 관리를 위한 주키퍼
2.2  주키퍼 설치
2.3  카프카 설치
2.4  카프카 상태 확인
2.5  카프카 시작하기
2.6  정리

## 2부 기본 개념과 운영 가이드
### 3장  카프카 디자인
3.1  카프카 디자인의 특징
3.2  카프카 데이터 모델
3.3  카프카의 고가용성과 리플리케이션
3.4  모든 브로커가 다운된다면
3.5  카프카에서 사용하는 주키퍼 지노드 역할
3.6  정리

### 4장  카프카 프로듀서
4.1  콘솔 프로듀서로 메시지 보내기
4.2  자바와 파이썬을 이용한 프로듀서
4.3  프로듀서 활용 예제
4.4  프로듀서 주요 옵션
4.5  메시지 전송 방법
4.6  정리

### 5장  카프카 컨슈머
5.1  컨슈머 주요 옵션
5.2  콘솔 컨슈머로 메시지 가져오기
5.3  자바와 파이썬을 이용한 컨슈머
5.4  파티션과 메시지 순서
5.5  컨슈머 그룹
5.6  커밋과 오프셋
5.7  정리

### 6장  카프카 운영 가이드
6.1  필수 카프카 명령어
6.2  주키퍼 스케일 아웃
6.3  카프카 스케일 아웃
6.4  카프카 모니터링
6.5  카프카 매니저
6.6  카프카 운영에 대한 Q&A
6.7  정리

## 3부 카프카의 확장과 응용
### 7장  카프카를 활용한 데이터 파이프라인 구축
7.1  카프카를 활용한 데이터 흐름도
7.2  파일비트를 이용한 메시지 전송
7.3  나이파이를 이용해 메시지 가져오기
7.4  실시간 분석을 위해 엘라스틱서치에 메시지 저장
7.5  키바나를 이용해 엘라스틱서치에 저장된 데이터 확인
7.6  현재의 토픽을 이용해 새로운 토픽으로 메시지 재생산
7.7  정리

### 8장 카프카 스트림즈 API
8.1  스트림 프로세싱 기초
8.2  카프카 스트림즈
8.3  카프카 스트림즈를 위한 환경설정
8.4  파이프 예제 프로그램 만들기
8.5  행 분리 예제 프로그램 만들기
8.6  단어 빈도수 세기 예제 프로그램 만들기
8.7  정리

### 9장  카프카 SQL을 이용한 스트리밍 처리
9.1  KSQL의 등장 배경
9.2  KSQL과 카파 아키텍처
9.3  KSQL 아키텍처
9.4  도커를 이용한 KSQL 클러스터 설치
9.5  KSQL을 이용한 스트림 분석
9.6  정리

### 10장  그 밖의 클라우드 기반 메시징 서비스
10.1  구글의 펍/섭 서비스 소개
10.2  구글의 펍/섭 서비스 연동
10.3  펍/섭 파이썬 SDK 사용하기
10.4  아마존 키네시스 서비스 소개
10.5  아마존 키네시스 연동
10.6  아마존 키네시스 자바 SDK 사용하기
10.7  카프카와 클라우드 서비스와의 비교v
10.8  정리

### 부록 도커를 이용한 카프카 설치
A.1  도커 설치
A.2  도커 버전 카프카 설치