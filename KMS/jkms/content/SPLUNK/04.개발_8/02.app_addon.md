# App 또는 Add-on 만들기

## 스플렁크 엔터프라이즈용 App 또는 Add-on 만들기

스플렁크 엔터프라이즈 또는 스플렁크 클라우드용 App 또는 Add-on개발을 시작하려면 다음이 필요

- 스플렁크 엔터프라이즈 테스트 환경
    랩톱과 같은 단일 인스턴스 개발 환경에서 Splunk Enterprise 설치를 사용
    지원되는 컴퓨팅 환경에 대한 자세한 내용은 설치 설명서의 스플렁크 엔터프라이즈 온-프레미스 사용에 대한 시스템 요구 사항을 참조
- 개발 도구.
    Splunk Web에는 구문 강조 표시 및 자동 들여쓰기 기능이 있는 기본 제공 소스 코드 편집기 또는 XML, CSS 및 HTML 파일에 대한 사용자 고유의 편집기 사용. 웹 브라우저에 포함된 디버깅 도구를 사용할 수도 있음
- 앱에 대한 계획.
    앱의 범위를 결정하고 해결하려는 사용 사례를 결정합니다. 앱을 스토리보드하고 대시보드, 패널 및 탐색의 모형을 만듭니다.
- 샘플 데이터.
    작업할 데이터와 데이터를 가져올 방법을 결정합니다. 앱을 테스트하기 위해 몇 가지 샘플 데이터를 가져옵니다.

## Splunk 앱을 개발하기 위한 기본 프로세스는 다음과 같습니다.

1. 스플렁크 웹을 사용하여 앱을 만듭니다. 자세한 내용은 Splunk 앱 만들기를 참조하고 앱 디렉터리 구조구성에 대해 자세히 알아봅니다.
2. 앱구성 설정 및 정적 자산과 같은 앱 속성을 구성합니다. 자세한 내용은 앱 속성 구성을 참조하십시오.
3. 데이터 입력, 인덱스 및 모듈식 입력을 사용하여 Splunk에 데이터를 가져옵니다. 자세한 내용은 데이터 계층 구성을 참조하십시오.
4. Splunk 검색 언어를 사용하여 데이터를 검색하고 검색을 최적화합니다(필터, 범위 제한, 실시간 검색 피하기). 자세한 내용은 검색 설명서를참조하십시오.
5. 저장된 검색, 이벤트 유형, 트랜잭션, 태그, 필드 추출, 변환, 조회, 검색 명령 및 데이터 모델과 같은 Splunk 지식 개체로 검색을 보강합니다. 자세한 내용은 기술 자료 구성을 참조하십시오.
6. 앱의 개체에 대한 권한을 설정하여 사용자가 볼 수 있는(읽기) 및 상호 작용(쓰기)을 지정합니다. 자세한 내용은 Splunk 앱의 개체에 대한 사용 권한 설정을 참조하십시오.
즉시 사용 가능한 경고 작업과 다른 시스템과 통합할 사용자 지정 경고 작업을 모두 사용하여 경고를 만듭니다. 자세한 내용은 경고 매뉴얼을 참조하십시오.

## 스플렁크 앱 만들기

Splunk Web을 사용하여 스플렁크 앱을 만들어 앱 및 필수 파일에 대한 디렉터리 구조를 생성합니다.

1. 스플렁크 웹 홈 페이지에서 앱옆에 있는 기어 아이콘을 클릭합니다.
2. 앱 만들기를클릭합니다.
3. 새 추가 페이지에서 새 앱의 속성을 입력합니다.

<table>
<tr><td>OPTION</td><td>DESCRIPTION</td></tr>
<tr><td>Name</td><td>The name of your app, which appears in the Splunk Web list and menu of apps.
The name maps to the label setting in the app.conf configuration file.
If you plan to upload your app to Splunkbase, follow the naming conventions as described in Naming conventions for apps and add-ons on Splunkbase in the Working with Splunkbase manual.
Tip Short app names are recommended to avoid issues with long file paths in Windows.</td></tr>
<tr><td>Folder name</td><td>The name to use for the directory in $SPLUNK_HOME/etc/apps/.
The name of the folder cannot contain the "dot" (.) character.</td></tr>
<tr><td>Version</td><td>The app version string.</td></tr>
<tr><td>Visible</td><td>Indicates whether the app should be visible in Splunk Web.
Apps that contain a user interface should be visible.</td></tr>
<tr><td>Description</td><td>A description of the app.
Previous versions of Splunk Enterprise displayed the description on the Splunk Home page, however the current version of Splunk Enterprise does not use this description. If you plan to upload your app to Splunkbase, include a description because Splunkbase uses it to validate the app package.</td></tr>
<tr><td>Author</td><td>The author name.</td></tr>
<tr><td>Template</td><td>The template to use for creating your app.
Select the "barebones" template to generate a basic app directory structure and a few required files.
The "sample_app" template creates an app that includes sample dashboards, images, and CSS files for dashboard styling and behavior.
Tip You can create and add custom app templates to $SPLUNK_HOME/share/splunk/app_templates/.</td></tr>
<tr><td>Upload asset</td><td>Click Choose File to upload a single image, HTML, JavaScript, CSS, or other asset file to your app.</td></tr>
</table>

4. 앱에 대한 새 디렉터리$SPLUNK_HOME/etc/앱 디렉토리 아래에 만들어집니다. 다음 표에서는 Splunk 앱에서 사용하는 일부 디렉터리를 보여 주며 있습니다. 필요한 디렉터리 "베어본" 템플릿을 사용할 때 만들어집니다. 가능한 모든 디렉터리에 대한 자세한 내용은 앱 디렉터리 구조를참조하십시오.

<table>
<tr><td>디렉터리</td><td>설명</td></tr>
<tr><td>./app_name</td><td>앱의 디렉터리, app_name $SPLUNK_HOME/etc/apps .</td></tr>
<tr><td>./app_name/appserver</td><td>이미지 및 스타일 시트와 같은 리소스 파일이 포함.</td></tr>
<tr><td>./app_name/appserver/static</td><td>CSS, JS 확장자 및 아이콘 파일을 포함한 리소스 파일이 포함. 자세한 내용은 클라이언트 및 서버 자산 캐싱을 참조.</td></tr>
<tr><td>./app_name/bin</td><td>검색 또는 스크립팅된 입력에 대한 사용자 지정 스크립트를 포함.</td></tr>
<tr><td>./app_name/default</td><td>앱 및 대시보드 파일에 필요한 구성을 포함.</td></tr>
<tr><td>./app_name/default/data</td><td>탐색 및 대시보드 파일이 포함.</td></tr>
<tr><td>./app_name/default/data/ui</td><td>탐색 및 대시보드 파일이 포함.</td></tr>
<tr><td>./app_name/default/data/ui/html</td><td>변환된 대시보드(HTML 파일)를 포함.</td></tr>
<tr><td>./app_name/default/data/ui/nav</td><td>앱의 탐색 파일인 default.xml을 포함.</td></tr>
<tr><td>./app_name/default/data/ui/views</td><td>앱과 관련된 간단한 XML 대시보드가 포함.</td></tr>
<tr><td>./app_name/local</td><td>/default에 있는 기본 구성 파일 또는 대시보드의 수정된 버전을 포함. Splunk Enterprise는 사용자가 변경할 때 이 디렉터리를 만듬.</td></tr>
<tr><td>./app_name/local/data</td><td>수정된 대시보드를 포함.</td></tr>
<tr><td>./app_name/local/data/ui</td><td>수정된 대시보드를 포함.</td></tr>
<tr><td>./app_name/local/data/ui/html</td><td>변환된 대시보드(HTML 파일)를 포함.</td></tr>
<tr><td>./app_name/local/data/ui/views</td><td>수정된 간단한 XML 대시보드(XML 파일)가 포함.</td></tr>
<tr><td>./app_name/lookups</td><td>조회 테이블(CSV 파일)을 포함.</td></tr>
<tr><td>./app_name/metadata</td><td>사용 권한(META 파일)이 포함. default.meta 파일은 앱에 대한 기본 권한을 설정. 사용자가 권한을 재정의하는 권한은 local.meta 파일에 설정</td></tr>
<tr><td>./app_name/static</td><td>아이콘 파일을 포함한 리소스 파일이 포함</td></tr>
</table>

## App 디렉토리 구성

- 대시보드는 `$SPLUNK_HOME/etc/apps/appname/default/data/ui/views/dashboardname.xml`에 저장
- JS 확장은 `$SPLUNK_HOME/etc/apps/appname/appserver/static/dashboardname.js`에 저장
- 데이터소스에서 데이터를 가져오는 모듈식 입력은 `$SPLUNK_HOME/etc/apps/appname/bin/appname_inputname.py`에 저장

주어진 앱에 대한 모든 패키지 구성 요소는 `$SPLUNK_HOME/etc/apps` 아래의 디렉토리(your_app)

```bash
your_app
    |__appserver
    |    |__ static  
    |              |__ // App resources like CSS, images, JavaScript extensions
    |    |__ event_renderers
    |              |__ // Supporting files for custom event rendering 
    |__bin
    |    |__ // Entry points for app code should start with your_app_*.py  
    |    |__ your_app
    |              |__ // All other non-entry point app code
    |__default
    |    |__ // .conf files containing the app's default configuration
    |    |__ data
    |              |__ ui
    |                   |__ nav
    |                        |__ // Top-level nav for the app
    |                   |__ views
    |                        |__ // SimpleXML dashboards
    |                   |__ html
    |                        |__ // HTML dashboards
    |__local
    |    |__ // .conf files containing user's configuration modifications
    |    |__ // Same internal structure as default
    |    |__ // Packaged Splunk apps should not contain a local folder
    |__ lib
    |    |__ // All app dependencies including splunklib
    |__ lookups
    |    |__ // .csv lookup files
    |__ metadata
    |    |__ // .meta files for permissions management
    |__ static
    |    |__ // App icon and app logo images
```

기본 및 지역 디렉토리는 서로의 하위 디렉토리 구조를 반영. 로컬의 앱별 사용자 지정은 기본 디렉토리의 해당 항목보다 우선합니다. 패키지 된 Splunk 앱에는 로컬 디렉토리가 포함되지 않아야합니다. 그렇지 않으면 로컬 디렉토리가 고객이 앱 사본에 대해 구성한 내용을 겹쳐 쓸 수 있습니다. 또한 앱 업그레이드 중에 로컬 디렉토리가 유지되는 동안 기본 구성이 재정의됩니다. 로컬 과 기본값 사이의 파일 우선 순위에 대한 자세한 내용은 파일 우선 순위 및 캐싱 정보를 참조하십시오 .

Python 앱의 경우 몇 가지 특정 추가 요구 사항

- conf 파일이 참조하는 모든 Python 파일은 bin에 저장 해야하며 appname _ *. py 규칙을 사용하여 고유하게 이름을 지정해야합니다 .
- 앱의 추가 Python 파일은 bin/appname 내의 하위 디렉토리에 저장해야합니다 . 이 폴더 내의 파일에는 이름 지정 제한이 없습니다.
- 필요한 경우를 포함하여 모든 Python 종속성은 bin이 아닌 lib에 저장해야 합니다. 앱 의 폴더에 패키징 하는 경우 시스템에 존재할 수 있는 다른 버전이 아닌 앱이 해당 버전을 호출하도록 경로에 추가해야 합니다. 경로에 추가하려면 앱의 기본 스크립트에서 다음과 같은 코드를 사용하십시오.

splunklib splunklib lib lib splunklib splunklib lib

```py
import sys, os
sys.path.insert(0, os.path.join(os.path.dirname(__file__), "..", "lib"))
```

아래는 이러한 Python 앱별 규칙의 구현 예를 보여줍니다.

```bash
your_app
    |__default
    |    |__ app.conf
    |__bin
    |    |__ your_app_entry_point.py
    |    |__ your_app
    |              |_ other_your_app_code.py
    |__ lib
          |__ dependency_code.py
```
